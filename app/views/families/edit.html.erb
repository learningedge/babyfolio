<div class="container settings my-family-info">

  <div id="left">
    <div id="title">Edit Account</div>
    <div id="change-form">
      <a href="<%= edit_account_path %>">Main Settings</a>
      <a href="#" class="current">My Family Info</a>
      <a href="<%= family_relations_families_path %>">Friends & Families</a>
      <%= render 'select_family', :parenting_families => true %>   
    </div>
  </div>
  
  <div class="user-form update_form">
    <%= render "shared/error_messages", :target => @family %>
    <h2>Family details</h2>

    <%= form_for @family, :method => 'put' do |f| -%>

      <%= f.label :name, "Family Name: " %>
      <%= f.text_field :name %>
      <%= f.label :zip_code, "Zip Code: " %>
      <%= f.text_field :zip_code %>

      <br/>
      <br/>
      <h2>Children</h2>
      <div class="user_form">
        <%= f.fields_for :children do |child_form| %>
          <div class="single_child" style="<%=  'display: block' if (child_form.object.first_name or child_form.object.birth_date) %>">
            <div class="left-column">
              <div class="row">
                <%= child_form.label :first_name, "First Name: "%>
                <%= child_form.text_field :first_name %>
              </div>
              <div class="row">
                <%= child_form.label :birth_date, "Birth Date: "%>
                <%= child_form.date_select :birth_date, {:default => child_form.object.formated_birth_date}, {:class => "select-layout"} -%>
              </div>
              <div class="row">
                <%= child_form.label :gender, "Gender: "%>
                <%= child_form.select :gender, options_for_select(Child::GENDERS, child_form.object.gender), {}, {:class => "select-layout"} %>
              </div>
            </div>
            <div class="right-column">
              <% unless child_form.object.id.nil? %>
                <div class="row">
                  <%= link_to "Change Profile's Image", edit_child_path(child_form.object) -%>
                  <span class="profile-image">
                    <%= get_image_tag child_form.object, "small" -%>
                  </span>
                </div>
                <div class="row">
                  <%= link_to "Info about child profile", info_children_path(:id => child_form.object.id) -%>
                </div>
              <% end %>
            </div>
            <div class="clear"></div>
          </div>
        <% end %>
        <%= link_to "Add another child" , '#', { :class => 'add_child_btn' } %>

        <br/>
        <br/>
        <div class="submit">
          <%= f.submit "Update" %>
        </div>
      <% end %>
    </div>
  </div>

  <div class="clear"></div>
</div>


<script type="text/javascript">
  $(function() {
  $('.single_child').first().show();
  $('.add_child_btn').click(function() {
  var display_btn = $(this).parents('form').find('.single_child:hidden').length <= 1;
  $(this).parents('form').find('.single_child:hidden').first().fadeIn();
  if(display_btn) $(this).fadeOut();
  return false;
  });
<%#*$('.remove_child_btn').click(function() {%>
<%#*$(this).parents('span').find('input[type="checkbox"]').click();%>
<%#*$(this).parents('.single_child').fadeOut().removeClass('single_child');%>
<%#*alert($(this).parents('span').find('input[type="checkbox"]').attr('checked'));%>
<%#*});%>
  $('.birth_date_input').datepicker();
  });
</script>



