<div class="container settings child-image">

  <div id="left">
    <div id="title">Child's Image</div>
  </div>

  <div class="user-form update_form">

    <%#= render "shared/error_messages", :target => @family %>
    
    <h2>Upload Image for <%= @child.first_name -%>'s profile</h2>
    <div class="images-container">

      <div class="profile-image">
        <%= image_tag @child.profile_image.url(:large) %>
      </div>
      
      <%= form_for @child,:html => { :multipart => true } do |f| -%>

        <div>
          <%= f.file_field :profile_image, :onchange => '$("#child_profile_image_remote_url").val("")'  -%>
        </div>
        <div>
          <%= f.hidden_field :profile_image_remote_url -%>
        </div>
      
        <div>
          <%= f.submit 'Update Image' %>
        </div>
      
      <% end %>

      <div class="clear"></div>
      
    </div>
    
    <h2>OR choose one from facebook</h2>

    <div class="profile-image">


    </div>
    
    <h2>OR flicker</h2>
    <div class="profile-image">
      <% @flickr_images.each do |flickr_image| %>
        <% info = flickr.photos.getInfo(:photo_id => flickr_image.id) %>

          <% url = FlickRaw.url(info) %>
      
          <div class="image flickr-image <%= 'active' if @child.profile_image_remote_url == url -%>" url="<%= url -%>">
            <%= image_tag FlickRaw.url_s(info) -%>
          </div>

      <% end %>
    </div>
  </div>

  <div class="clear"></div>
</div>
<script type="text/javascript">
  $('.image').click(function(){
    $('#child_profile_image_remote_url').val($(this).attr('url'));
    $('.image').removeClass('active');
    $(this).addClass('active');
  })
</script>